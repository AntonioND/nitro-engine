# SPDX-License-Identifier: MIT
#
# Copyright (c) 2008-2009, 2019, Antonio Niño Díaz
#
# This file is part of Nitro Engine

NAME		:= nitro_texture_converter
# Either leave the extension empty or assign .exe to it for Windows
EXT		:=

PKG_CONFIG	:= pkg-config
PNGCFLAGS	:= `$(PKG_CONFIG) --static --cflags libpng`
PNGLDFLAGS	:= `$(PKG_CONFIG) --static --libs-only-L libpng`
PNGLDLIBS	:= `$(PKG_CONFIG) --static --libs-only-l libpng`

CFLAGS		:= -Wall
RM		:= rm -rf

all: $(NAME)$(EXT)

OBJS := \
	convert_a1rgb5.o \
	convert_a3rgb32.o \
	convert_a5rgb8.o \
	convert_depthbmp.o \
	convert_rgb16.o \
	convert_rgb256.o \
	convert_rgb4.o \
	load_png.o \
	nitro_texture_converter.o \
	palette.o \

$(NAME)$(EXT): $(OBJS)
	$(CC) $(CFLAGS) $(PNGLDFLAGS) -o $@ $(OBJS) $(PNGLDLIBS)

.c.o:
	$(CC) $(CFLAGS) $(PNGCFLAGS) -c -o $@ $<

# Target used to remove all files generated by other Makefile targets

clean:
	$(RM) $(NAME) $(NAME).exe $(OBJS)

# Targets to cross-compile Windows binaries from Linux. Not used to compile
# natively from Windows.

mingw32:
	env PKG_CONFIG_PATH=/usr/i686-w64-mingw32/sys-root/mingw/lib/pkgconfig/ \
		make CC=i686-w64-mingw32-gcc EXT=.exe

mingw64:
	env PKG_CONFIG_PATH=/usr/x86_64-w64-mingw32/sys-root/mingw/lib/pkgconfig/ \
		make CC=x86_64-w64-mingw32-gcc EXT=.exe
